<% provide(:title, "#{@user.name}さんのページ") %>

<p class="lead"><%= yield(:title) %></p>
<div class="d-flex justify-content-center">
  <div class="col-sm-5">
    <div class="card mb-3">
    <% if @user.image.attached? %>
      <%= image_tag @user.image, class: 'card-img-top', alt: 'Card image cap' %>
    <% else %>
      <%if @user.id == current_user.id %>
        <%=image_tag mypage_demo_image, class: 'card-img-top', alt: 'Card image cap' %>
      <% else %>
        <%=image_tag user_demo_image, class: 'card-img-top', alt: 'Card image cap' %>
      <% end %>
    <% end %>
      <div class="card-body">
        <p class="card-text"><span class="small text-muted"><%= User.human_attribute_name(:hobby) %>：</span><%= @user.hobby %></p>
        <p class="card-text"><span class="small text-muted"><%= User.human_attribute_name(:character) %>：</span><%= @user.character %></p>
        <%# 5ポイントブロック %>
        <% if current_user.id == @user.id || current_user.admin? %>
          <p class="card-text"><span class="small text-muted"><%= User.human_attribute_name(:email) %>：</span><%= @user.email %></p>
          <p class="card-text"><span class="small text-muted"><%= User.human_attribute_name(:sex) %>：</span><%= set_sex(@user) %></p>
          <p class="card-text"><span class="small text-muted"><%= User.human_attribute_name(:generation) %>：</span><%= set_generation(@user) %></p>
          <p class="card-text text-info font-weight-bold"><%= User.human_attribute_name(:point) %>：<span class="display-3"><%= @user.point %></span> pts</p>
        <% end %>
      </div>
    </div>
  </div>
</div>
<%# サブ画像ブロック %>
<% if @user.sub_image_1.attached? %>
  <p>
    <i class="fa-solid fa-image-portrait fa-3x  mt-5 text-secondary"></i>
  </p>
  <h3 class="my-3 py-3">- その他画像 -</h3>
  <%= image_tag @user.sub_image_1.variant(resize: "300x300"), class: 'mb-3 rounded border mx-2' %>
<% end %>
<% if @user.sub_image_2.attached? %>
  <%= image_tag @user.sub_image_2.variant(resize: "300x300"), class: 'mb-3 rounded border mx-2' %>
<% end %>
<%# 測定ブロック %>
<% if @user.id != current_user.id %>
  <div class='mx-auto my-3 arrow_box'>
    <span class="small">1人測定するたびに「1ポイント獲得」<br />（5ポイント消化で1人の詳細評価をのぞけます！）</span>
  </div>
  <p>
  <%= link_to '測定する！', new_evaluation_path(user_id: current_user.id, evaluatee_id: @user.id), class: "btn btn-border" %> 
  </p>
<% end %>

<%# 5ポイント以上でプロフチェック %>
<% if current_user.point >= 5 && @user.id != current_user.id %>
  <div class="mt-4">
    <%= link_to user_details_path(user_id: @user.id), method: :post, class: "btn btn-warning btn-lg rounded-pill text-white mb-45" do %><i class="fa-solid fa-address-card lead"></i> 評価をのぞく！<% end %>
  </div>
<% end %>

<%# 印象ブロック %>
<% if current_user.id == @user.id %>
  <%= render "impression" %>
<% end %>

<%# プロフの編集・削除 %>
<% if current_user.id == @user.id || current_user.admin? %>
  <div class="text-center">
    <%= link_to edit_user_path, class: "btn btn-info rounded-pill text-white mb-3" do %>
      <i class="fa-solid fa-pen-to-square"></i> プロフィール編集<br />
    <% end %><br />
    <%= link_to "退会する", @user, method: :delete, data: { confirm: "「#{@user.name}」さん、本当に退会しますか？"}, class: "small text-secondary" %>
  </div>
<% end %>
